<!doctype html>
<html>
  <body style="font:14px system-ui;padding:24px">
    <h3>Sandbox Upload (no React)</h3>
    <input id="f" type="file" multiple accept="image/*,application/pdf"/>
    <pre id="log"></pre>

    <script type="module">
      import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";
      // ðŸ‘‰ fill with your project values (safe for client):
      const SUPABASE_URL = "https://YOUR-PROJECT.supabase.co";
      const SUPABASE_ANON = "YOUR_ANON_KEY";
      const BUCKET = "submissions";

      const supabase = createClient(SUPABASE_URL, SUPABASE_ANON);
      const log = (m)=>document.getElementById('log').textContent += m + "\n";

      document.getElementById('f').addEventListener('change', async (e)=>{
        const files = Array.from(e.target.files||[]);
        const { data: userData, error: e1 } = await supabase.auth.getUser();
        if (e1 || !userData?.user) { alert("Sign in first in your app domain"); return; }
        const uid = userData.user.id;

        for (const f of files) {
          const key = `${uid}/${Date.now()}-${Math.random().toString(36).slice(2)}-${f.name.replace(/\s+/g,"_")}`;
          log("Uploading " + f.name + " â€¦");
          const { error } = await supabase.storage.from(BUCKET).upload(key, f, {
            contentType: f.type || "application/octet-stream",
            upsert: false,
            cacheControl: "3600",
          });
          if (error) { log("ERR: " + error.message); return; }
          log("OK â†’ " + key);
        }
        log("Done.");
      });
    </script>
  </body>
  </html>


